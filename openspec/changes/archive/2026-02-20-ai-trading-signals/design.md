## Context

用户需要在股票列表中看到买卖信号建议，包含具体的买点/卖点价位。系统已有多数据源支持 K 线数据获取，需要在此基础上增加技术指标计算和信号生成。

## Goals / Non-Goals

**Goals:**
- 支持多种技术指标计算（MA/MACD/RSI/KDJ/布林带）
- 生成买入/卖出信号，包含价位建议
- 信号在股票列表和趋势图中展示
- 支持每日收盘后自动计算

**Non-Goals:**
- 不实现机器学习模型预测
- 不支持实时盘中信号
- 不追踪历史信号准确性（V1 版本）

## Decisions

### 1. 技术指标计算：纯 Python 实现

**选择理由：**
- 简单，无需额外依赖
- 可控性强，方便调试
- 使用 pandas 向量化计算，性能足够

**依赖：**
- pandas（已有）
- numpy（已有）

### 2. 信号生成规则

```
买入信号规则:
┌─────────────────────────────────────────────────────────────────┐
│ 规则名称      │ 触发条件              │ 价位建议      │ 强度    │
├─────────────────────────────────────────────────────────────────┤
│ MA 金叉      │ MA5 上穿 MA20         │ MA20 价格     │ ⭐⭐⭐  │
│ RSI 超卖     │ RSI < 30              │ 当前价-2%     │ ⭐⭐    │
│ 布林下轨     │ 价格 < 布林下轨       │ 下轨价格      │ ⭐⭐⭐  │
│ MACD 金叉    │ DIF 上穿 DEA          │ 当前价        │ ⭐⭐    │
└─────────────────────────────────────────────────────────────────┘

卖出信号规则:
┌─────────────────────────────────────────────────────────────────┐
│ 规则名称      │ 触发条件              │ 价位建议      │ 强度    │
├─────────────────────────────────────────────────────────────────┤
│ MA 死叉      │ MA5 下穿 MA20         │ MA20 价格     │ ⭐⭐⭐  │
│ RSI 超买     │ RSI > 70              │ 当前价+2%     │ ⭐⭐    │
│ 布林上轨     │ 价格 > 布林上轨       │ 上轨价格      │ ⭐⭐⭐  │
│ MACD 死叉    │ DIF 下穿 DEA          │ 当前价        │ ⭐⭐    │
└─────────────────────────────────────────────────────────────────┘
```

### 3. 信号数据结构

```python
class Signal:
    stock_id: int
    signal_date: date
    signal_type: str  # "buy" / "sell" / "hold"
    price_target: float  # 建议价位
    stop_loss: float  # 止损价位
    take_profit: float  # 目标价位
    strength: int  # 1-3
    triggers: List[str]  # 触发条件列表
    indicators: Dict  # 指标快照
```

### 4. 前端展示位置

- **股票列表**：信号标签（买入🟢/卖出🔴/持有⚪）
- **趋势图对话框**：信号详情卡片（价位、强度、触发条件）

## Risks / Trade-offs

- **信号准确性** → 信号仅供参考，不做投资建议，前端显示免责声明
- **计算性能** → 只在用户请求时计算，或每日收盘后批量计算一次
- **数据延迟** → 使用 K 线收盘价计算，与实时价格可能有偏差
