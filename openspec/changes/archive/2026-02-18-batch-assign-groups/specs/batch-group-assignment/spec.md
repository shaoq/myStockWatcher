## ADDED Requirements

### Requirement: 用户可以批量将股票归属到分组

系统 SHALL 允许用户在股票列表中选中多只股票，并将它们批量归属到一个或多个分组。

#### Scenario: 成功批量归属到现有分组
- **WHEN** 用户选中 3 只股票，选择现有分组"科技板块"，点击确认
- **THEN** 系统将 3 只股票追加到"科技板块"分组，显示成功消息"已成功将 3 只股票归属到 1 个分组"

#### Scenario: 批量归属到多个分组
- **WHEN** 用户选中 2 只股票，选择分组"科技板块"和"长期持有"，点击确认
- **THEN** 系统将 2 只股票同时追加到两个分组，显示成功消息"已成功将 2 只股票归属到 2 个分组"

### Requirement: 支持自动创建不存在的分组

系统 SHALL 在用户输入不存在的分组名时自动创建该分组。

#### Scenario: 输入新分组名自动创建
- **WHEN** 用户选中股票，输入新分组名"新能源"并回车，点击确认
- **THEN** 系统创建"新能源"分组，并将选中股票归属到该分组，显示成功消息包含"新建分组：新能源"

#### Scenario: 混合选择现有和新建分组
- **WHEN** 用户选中股票，选择现有分组"科技板块"并输入新分组名"创业板"，点击确认
- **THEN** 系统创建"创业板"分组，将股票同时归属到"科技板块"和"创业板"

### Requirement: 采用追加模式归属

系统 SHALL 采用追加模式将股票归属到分组，保留股票原有的分组关系。

#### Scenario: 保留原有分组关系
- **GIVEN** 股票 A 已属于分组"白马股"
- **WHEN** 用户将股票 A 批量归属到分组"科技板块"
- **THEN** 股票 A 同时属于"白马股"和"科技板块"两个分组

### Requirement: 自动跳过已在分组内的股票

系统 SHALL 自动跳过已在目标分组内的股票，不重复添加。

#### Scenario: 部分股票已在分组内
- **GIVEN** 股票 A 已属于分组"科技板块"，股票 B 不属于
- **WHEN** 用户选中股票 A 和 B，批量归属到"科技板块"
- **THEN** 股票 A 被跳过（不重复添加），股票 B 成功添加，显示消息"1 只股票已归属，1 只已在分组内跳过"

### Requirement: 至少选择一个分组才能提交

系统 SHALL 要求用户至少选择或输入一个分组才能提交批量归属操作。

#### Scenario: 未选择分组时禁用提交
- **WHEN** 用户打开批量归属弹窗但未选择任何分组
- **THEN** 确认按钮处于禁用状态

#### Scenario: 清空所有分组后禁用提交
- **WHEN** 用户曾选择分组后又全部清空
- **THEN** 确认按钮处于禁用状态

### Requirement: 提供清晰的操作反馈

系统 SHALL 在批量归属操作完成后提供详细的反馈信息。

#### Scenario: 全部成功反馈
- **WHEN** 批量归属操作成功完成，无跳过
- **THEN** 显示成功消息"已成功将 X 只股票归属到 Y 个分组"

#### Scenario: 部分跳过反馈
- **WHEN** 部分股票已在分组内被跳过
- **THEN** 显示消息"X 只股票已归属，Y 只已在分组内跳过"

#### Scenario: 操作失败反馈
- **WHEN** 批量归属操作失败
- **THEN** 显示错误消息"操作失败：{具体错误原因}"

### Requirement: 前端 UI 交互设计

系统 SHALL 提供直观的批量归属弹窗界面。

#### Scenario: 显示已选股票数量
- **WHEN** 用户打开批量归属弹窗
- **THEN** 弹窗顶部显示"已选中 X 只股票"

#### Scenario: 分组输入方式
- **WHEN** 用户在分组选择框中操作
- **THEN** 可以从下拉列表选择现有分组，或输入新分组名后回车创建

#### Scenario: 输入提示
- **WHEN** 分组选择框获得焦点
- **THEN** 显示提示文字"可选择现有分组，或输入新名称回车创建"
